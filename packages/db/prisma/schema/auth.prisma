model User {
  id                    String                @id
  name                  String
  email                 String
  emailVerified         Boolean               @default(false)
  image                 String?
  createdAt             DateTime              @default(now())
  updatedAt             DateTime              @updatedAt
  sessions              Session[]
  accounts              Account[]
  role                  String?
  banned                Boolean?              @default(false)
  banReason             String?
  banExpires            DateTime?
  twoFactorEnabled      Boolean?              @default(false)
  deletedAt             DateTime?
  isDeleted             Boolean?              @default(false)
  files                 File[]
  folders               Folder[]
  notifications         Notification[]
  auditLogs             AuditLog[]
  clinicMembers         ClinicMember[]
  doctor                Doctor?
  staff                 Staff?
  guardians             Guardian[]
  clinicId              String?
  userQuotas            UserQuota[]
  medicalRecordAccesses MedicalRecordAccess[]
  clinic                Clinic?               @relation("ClinicUsers", fields: [clinicId], references: [id])
  patient               Patient?              @relation("PatientUser")
  patients              Patient[]             @relation("PatientCreatedBy")
  patientId             String?

  phone      String?
  isAdmin    Boolean?    @default(false)
  twofactors TwoFactor[]

  @@unique([email])
  @@index([emailVerified])
  @@index([banned])
  @@index([isDeleted])
  @@index([role, createdAt])
  @@index([createdAt(sort: Desc)])
  @@map("user")
}

model Session {
  id        String   @id
  expiresAt DateTime
  token     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  ipAddress String?
  userAgent String?
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  impersonatedBy String?

  @@unique([token])
  @@index([userId])
  @@map("session")
}

model Account {
  id                    String    @id
  accountId             String
  providerId            String
  userId                String
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt

  @@index([userId])
  @@map("account")
}

model Verification {
  id         String   @id
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@index([identifier])
  @@map("verification")
}

model TwoFactor {
  id          String @id
  secret      String
  backupCodes String
  userId      String
  user        User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([secret])
  @@index([userId])
  @@map("twoFactor")
}
